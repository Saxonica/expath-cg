<?xml version="1.0" encoding="US-ASCII"?>
<test-set xmlns="http://www.w3.org/2010/09/qt-fots-catalog"
          xmlns:file="http://expath.org/ns/file"
          xmlns:map="http://www.w3.org/2005/xpath-functions/map"
          name="expath-archive">
    <description>Tests for the extension functions in the EXPath "archive" package. Note the tests
        are written on the assumption that the "working directory" for resolving relative filenames
        is the directory containing this test catalog file.</description>
   <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/archive-definition.xml at 2014-10-02T09:59:43.797+01:00-->
    <link type="spec" document="http://expath.org/spec/archive"/>


    <environment name="EXPath-archive">
        <namespace prefix="arch" uri="http://expath.org/ns/archive"/>
        <namespace prefix="file" uri="http://expath.org/ns/file"/>
        <namespace prefix="bin" uri="http://expath.org/ns/binary"/>

        <param name="test1.ZIP"
             select="Q{http://expath.org/ns/file}read-binary('sandpit/test1.zip')"/>
        <param name="test1.ZIP.BROKEN"
             select="Q{http://expath.org/ns/binary}part(Q{http://expath.org/ns/file}read-binary('sandpit/test1.zip'),4,50)"/>
        <param name="test3.ZIP"
             select="Q{http://expath.org/ns/file}read-binary('sandpit/test3.zip')"/>

        <param name="textA" select="'textA.txt'"/>

        <param name="simple.Text"
             select="Q{http://expath.org/ns/binary}encode-string('A simple string','UTF-8')"/>
        <param name="empty.bin" select="xs:base64Binary('')"/>
    </environment>

    <environment name="EXPath-archive.map">
        <namespace prefix="arch" uri="http://expath.org/ns/archive"/>
        <namespace prefix="file" uri="http://expath.org/ns/file"/>
        <namespace prefix="bin" uri="http://expath.org/ns/binary"/>
        <namespace prefix="map" uri="http://www.w3.org/2005/xpath-functions/map"/>


        <param name="test1.ZIP"
             select="Q{http://expath.org/ns/file}read-binary('sandpit/test1.zip')"/>
        <param name="test1.ZIP.BROKEN"
             select="Q{http://expath.org/ns/binary}part(Q{http://expath.org/ns/file}read-binary('sandpit/test1.zip'),4,50)"/>
        <param name="test3.ZIP"
             select="Q{http://expath.org/ns/file}read-binary('sandpit/test3.zip')"/>

        <param name="textA" select="'textA.txt'"/>
        <param name="known.test1"
             select="Q{http://www.w3.org/2005/xpath-functions/map}new(Q{http://www.w3.org/2005/xpath-functions/map}entry('textA.txt',()))"/>
        <param name="unknown.test1"
             select="Q{http://www.w3.org/2005/xpath-functions/map}new(Q{http://www.w3.org/2005/xpath-functions/map}entry('foo',()))"/>
        <!--<param name="map" select="map{'foo' : 1}"/>-->
        <param name="simple.Text.string" select="'A simple string'"/>
        <!-- <param name="simple.Text.map"
            select="map { 
            'simple.Text' : map{'content' :bin:encode-string('A simple string','UTF-8')}
            }"/>-->
        <param name="simple.Text.map"
             select="Q{http://www.w3.org/2005/xpath-functions/map}new(Q{http://www.w3.org/2005/xpath-functions/map}entry('simple.Text',Q{http://www.w3.org/2005/xpath-functions/map}new(Q{http://www.w3.org/2005/xpath-functions/map}entry('content',Q{http://expath.org/ns/binary}encode-string('A simple string','UTF-8'))             )))"/>
        <param name="empty.bin" select="xs:base64Binary('')"/>
    </environment>

    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/parts/options.xml at 2014-10-02T09:59:43.797+01:00--><link xmlns:arch="http://expath.org/ns/archive"
         type="spec"
         document="http://expath.org/spec/archive"/>
   <test-case xmlns:arch="http://expath.org/ns/archive" name="EXPath-archive-options-001">
      <description>Options for a ZIP file</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:options($test1.ZIP)
            </test>
      <result>
                <all-of>
                    <assert-type>element(Q{http://expath.org/ns/archive}options)</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case xmlns:arch="http://expath.org/ns/archive" name="EXPath-archive-options-002">
      <description>Format for a ZIP file</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> 
                string(arch:options($test1.ZIP)/@format)
            </test>
      <result>
                <assert-eq>'zip'</assert-eq>
            </result>
   </test-case>
   <test-case xmlns:arch="http://expath.org/ns/archive" name="EXPath-archive-options-003">
      <description>Compression for a ZIP file</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> 
                string(arch:options($test1.ZIP)/@compression)
            </test>
      <result>
                <assert-eq>'unknown'</assert-eq>
            </result>
   </test-case>
    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/parts/entries.xml at 2014-10-02T09:59:43.797+01:00--><link type="spec" document="http://expath.org/spec/archive"/>
   <test-case name="EXPath-archive-entries-001">
      <description>Count entries in a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> arch:entries($test1.ZIP) </test>
      <result>
                <all-of>
                    <assert-type>element(Q{http://expath.org/ns/archive}entry)</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-002">
      <description>Count entries in a multi-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> arch:entries($test3.ZIP) </test>
      <result>
                <all-of>
                    <assert-type>element(Q{http://expath.org/ns/archive}entry)*</assert-type>
                    <assert-count>3</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-003">
      <description>Entries in a multi-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> for $e in arch:entries($test3.ZIP) return string($e) </test>
      <result>
                <all-of>
                    <assert-permutation>('textA.txt','textB.txt','textC.txt')</assert-permutation>
                </all-of>
            </result>
   </test-case>
    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/parts/extraction.xml at 2014-10-02T09:59:43.797+01:00--><link type="spec" document="http://expath.org/spec/archive"/>
   <test-case name="EXPath-archive-extract-binary-001">
      <description>Unknown entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:extract-binary($test1.ZIP,'foo')
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-entry"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-binary-002">
      <description>Known entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:extract-binary($test1.ZIP,$textA)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-binary-003">
      <description>Known entry - duplication</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:extract-binary($test1.ZIP,($textA,$textA))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary*</assert-type>
                    <assert-count>2</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-001">
      <description>Unknown entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:extract-text($test1.ZIP,'foo')
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-entry"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-002">
      <description>Checking default coding, and lower/upper case</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:extract-text($test1.ZIP,$textA)
                = arch:extract-text($test1.ZIP,$textA,'UTF-8') and
                arch:extract-text($test1.ZIP,$textA)
                = arch:extract-text($test1.ZIP,$textA,'utf-8')
            </test>
      <result>
                <assert-true/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-003">
      <description>Checking unknown coding</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
               arch:extract-text($test1.ZIP,$textA,'NOT-UTF-8')
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-encoding"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-004">
      <description>Checking unknown coding</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
               arch:extract-text($test1.ZIP,$textA)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string</assert-type>
                    <assert-eq>'Some text here'</assert-eq>
                </all-of>
            </result>
   </test-case>
    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/parts/updating.xml at 2014-10-02T09:59:43.797+01:00--><link type="spec" document="http://expath.org/spec/archive"/>
   <test-case name="EXPath-archive-delete-001">
      <description>Delete entry from a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:delete($test1.ZIP,($textA))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-delete-002">
      <description>Deletion with empty deletion request</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:delete($test1.ZIP,()) = $test1.ZIP
            </test>
      <result>
                <assert-true/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-delete-003">
      <description>Delete entry from a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:entries(arch:delete($test1.ZIP,($textA)))
            </test>
      <result>
                <assert-empty/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-delete-004">
      <description>Delete unknown entry from a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:delete($test1.ZIP,('textNOTTHERE.txt'))
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-entry"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-001">
      <description>Update entry in a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:update($test1.ZIP,$textA,$simple.Text)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-002">
      <description>Update entry in a one-entry zip - already there </description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                for $ e in arch:entries(arch:update($test1.ZIP,$textA,$simple.Text))
                return string($e) 
            </test>
      <result>
                <assert-permutation>('textA.txt')</assert-permutation>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-003">
      <description>Update entry in a one-entry zip - new entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> 
                arch:update($test1.ZIP,'new.txt',$simple.Text)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-004">
      <description>Update entry in a one-entry zip - new entry </description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                for $ e in arch:entries(arch:update($test1.ZIP,'new.txt',$simple.Text))
                return string($e)
            </test>
      <result>
                <assert-permutation>('new.txt','textA.txt')</assert-permutation>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-005">
      <description>Update entry in a one-entry zip - new entry </description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test>
                arch:extract-binary(arch:update($test1.ZIP,'new.txt',$simple.Text),'new.txt')
                =  $simple.Text
            </test>
      <result>
                <assert-true/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-create-001">
      <description>Create a one-entry ZIP</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> 
                arch:create('new.txt',$simple.Text)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-create-002">
      <description>Create a one-entry ZIP</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive"/>
      <test> 
                arch:extract-binary(arch:create('new.txt',$simple.Text),'new.txt')
                = $simple.Text
            </test>
      <result>
                <assert-true/>
            </result>
   </test-case>

    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/maps/options.xml at 2014-10-02T09:59:43.797+01:00--><link xmlns:arch="http://expath.org/ns/archive"
         type="spec"
         document="http://expath.org/spec/archive"/>
   <test-case xmlns:arch="http://expath.org/ns/archive"
              name="EXPath-archive-options-map-001">
      <description>Options for a ZIP file</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                arch:options-map($test1.ZIP)
            </test>
      <result>
                <all-of>
                    <assert-type>map(xs:string,item()*)</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case xmlns:arch="http://expath.org/ns/archive"
              name="EXPath-archive-options-map-002">
      <description>Required properties set</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                map:keys(arch:options-map($test3.ZIP))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string*</assert-type>
                    <assert-permutation>'format','compression'</assert-permutation>
                </all-of>
            </result>
   </test-case>
   <test-case xmlns:arch="http://expath.org/ns/archive"
              name="EXPath-archive-options-map-003">
      <description>Format for a ZIP file</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                arch:options-map($test1.ZIP)('format')
            </test>
      <result>
                <assert-eq>'zip'</assert-eq>
            </result>
   </test-case>
   <test-case xmlns:arch="http://expath.org/ns/archive"
              name="EXPath-archive-options-map-004">
      <description>compression for a ZIP file</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                arch:options-map($test1.ZIP)('compression')
            </test>
      <result>
                <assert-eq>'stored'</assert-eq>
            </result>
   </test-case>
    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/maps/entries.xml at 2014-10-02T09:59:43.797+01:00--><link type="spec" document="http://expath.org/spec/archive"/>
   <test-case name="EXPath-archive-entries-map-001">
      <description>Count entries in a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                arch:entries-map($test1.ZIP)
            </test>
      <result>
                <all-of>
                    <assert-type>map(xs:string,map(xs:string,item()*))</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-map-002">
      <description>Count entries in a multi-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                map:keys(arch:entries-map($test3.ZIP))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string*</assert-type>
                    <assert-count>3</assert-count>
                    <assert-permutation>'textA.txt','textB.txt','textC.txt'</assert-permutation>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-map-003">
      <description>Size from a map</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                arch:entries-map($test3.ZIP)('textA.txt')('size')
            </test>
      <result>
                <all-of>
                    <assert-type>xs:integer</assert-type>
                    <assert-eq>14</assert-eq>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-map-004">
      <description>Required properties set</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                map:keys(arch:entries-map($test3.ZIP)('textA.txt'))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string*</assert-type>
                    <assert-permutation>'position','size','compressed-size','last-modified','compression'</assert-permutation>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-map-005">
      <description>Required properties set - with content</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                map:keys(arch:entries-map($test3.ZIP,true())('textA.txt'))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string*</assert-type>
                    <assert-permutation>'position','content','size','compressed-size','last-modified','compression'</assert-permutation>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-entries-map-006">
      <description>Type of content</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test> 
                arch:entries-map($test3.ZIP,true())('textA.txt')('content')
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/maps/extraction.xml at 2014-10-02T09:59:43.797+01:00--><link type="spec" document="http://expath.org/spec/archive"/>
   <test-case name="EXPath-archive-extract-binary-map-001">
      <description>Unknown entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                arch:extract-binary-map($test1.ZIP,$unknown.test1)
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-entry"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-binary-map-002">
      <description>Known entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                arch:extract-binary-map($test1.ZIP,$known.test1)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-map-001">
      <description>Unknown entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test>
                arch:extract-text-map($test1.ZIP,$unknown.test1)
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-entry"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-map-002">
      <description>Checking default coding, and lower/upper case</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test>
                arch:extract-text-map($test1.ZIP,$known.test1)
                = arch:extract-text-map($test1.ZIP,$known.test1,'UTF-8') and
                arch:extract-text-map($test1.ZIP,$known.test1)
                = arch:extract-text-map($test1.ZIP,$known.test1,'utf-8')
            </test>
      <result>
                <assert-true/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-map-003">
      <description>Checking unknown coding</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test>
               arch:extract-text-map($test1.ZIP,$known.test1,'NOT-UTF-8')
            </test>
      <result>
                <error code="Q{http://expath.org/ns/archive}unknown-encoding"/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-extract-text-map-004">
      <description>Checking with known coding</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test>
               arch:extract-text-map($test1.ZIP,$known.test1)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string</assert-type>
                    <assert-eq>'Some text here'</assert-eq>
                </all-of>
            </result>
   </test-case>
    <!--Autogenerated from file:/C:/Users/jwl/Documents/GitHub/expath-cg/tests/qt3/archive/maps/updating.xml at 2014-10-02T09:59:43.797+01:00--><link type="spec" document="http://expath.org/spec/archive"/>
   <test-case name="EXPath-archive-delete.map-001">
      <description>Delete entry from a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                arch:delete-map(arch:create-map($simple.Text.map),map:entry('simple.Text',()))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-delete.map-002">
      <description>Deletion with empty deletion request</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                let $a := arch:create-map($simple.Text.map)
                 return arch:delete-map($a,map:new(())) = $a
            </test>
      <result>
                <assert-true/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-delete.map-003">
      <description>Delete the only entry from a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <modified by="John Lumley" on="2014-10-02" change="XP30+ XQ30+ dependency"/>
      <environment ref="EXPath-archive.map"/>
      <dependency type="spec" value="XP30+ XQ30+"/>
      <test>
                map:keys(arch:entries-map(
                arch:delete-map(arch:create-map($simple.Text.map),$simple.Text.map)
                ))
            </test>
      <result>
                <assert-empty/>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-map-001">
      <description>Update entry in a one-entry zip</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test>
                arch:update-map($test1.ZIP,$simple.Text.map)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-update-map-002">
      <description>Update entry in a one-entry zip - new entry</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test> 
                map:keys(arch:entries-map(arch:update-map($test1.ZIP,$simple.Text.map)))
            </test>
      <result>
                <all-of>
                    <assert-type>xs:string*</assert-type>
                    <assert-count>2</assert-count>
                    <assert-permutation>('textA.txt','simple.Text')</assert-permutation>
                </all-of>
            </result>
   </test-case>
   <test-case name="EXPath-archive-create-map-001">
      <description>Create a one-entry ZIP</description>
      <created by="John Lumley" on="2013-08-28"/>
      <modified by="John Lumley" on="2014-08-11" change="consistent EXPath naming"/>
      <environment ref="EXPath-archive.map"/>
      <test> 
                arch:create-map($simple.Text.map)
            </test>
      <result>
                <all-of>
                    <assert-type>xs:base64Binary</assert-type>
                    <assert-count>1</assert-count>
                </all-of>
            </result>
   </test-case>


</test-set>
