<!DOCTYPE html>
<html>
  <head>
    <title>HTTP Client Module 2.0</title>
    <meta charset='utf-8'/>
    <script src='http://www.w3.org/Tools/respec/respec-w3c-common' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus: "base",

          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName: "http-client2",

          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          subtitle: "An EXPath Project",

          // if you wish the publication date to be other than today, set this
          // publishDate:  "2009-08-06",

          // if the specification's copyright date is a range of years, specify
          // the start date here:
          // copyrightStart: "2005"

          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          // previousPublishDate:  "1977-03-15",
          // previousMaturity:  "WD",

          // if there a publicly available Editor's Draft, this is the link
          // edDraftURI:           "http://dev.w3.org/2009/dap/ReSpec.js/documentation.html",
          edDraftURI: "http://expath.github.io/expath-cg/specs/http-client2/",

          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Christian Grün", url: "http://christian-gruen.de/",
                company: "BaseX GmbH", companyURL: "http://basex.org/" },
              { name: "Adam Retter", url: "http://adamretter.org.uk/",
                company: "Evolved Binary", companyURL: "http://adamretter.org.uk/" }
          ],

          // authors, add as many as you like.
          // This is optional, uncomment if you have authors as well as editors.
          // only "name" is required. Same format as editors.
          //authors:  [
          //],

          // name of the WG
          wg: "EXPath Community Group",

          // URI of the public WG page
          wgURI: "https://www.w3.org/community/expath/",

          // name (without the @w3c.org) of the public mailing to which comments are due
          //wgPublicList: "exquery-restxq",

          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "",

          // If specified, defines an array of alternate formats in which document is available (e.g., XML, Postscript). The format of the array is:
          // alternateFormats:

          doRDFa: "1.1",
      };
    </script>
  </head>
  <body>
    <!--<section id="sotd"/>
    </section>-->

    <section id='abstract'>
      <p>
        This specification provides an HTTP client interface for XML languages.
        It defines several extension functions to perform HTTP requests.
        It is backward-compliant with version 1.0 of the
        <a href='http://expath.org/spec/http-client/'>HTTP Client Module</a>
        and has been designed to be compatible with [[!XQUERY-31]] and [[!XPATH-31]].
      </p>
    </section>

    <section id='introduction'>
      <h2>Introduction</h2>
      <p>
        Version 2.0 of the HTTP Client Module specification provides the following new features:
        <ul>
          <li> With [[!XPATH-31]], maps and arrays were added.
            In the new functions, we take advantage of the new data structures.</li>
          <li> Convenience functions are provided to make basic user requests more convenient.</li>
          <li> The old specification provided multiple ways to supply arguments, such as the request URI
            and the payload. In the new functions, the location for all arguments is unique.</li>
          <li> Single and multipart payloads are supplied without intermediate serialization.
            This facilitates implementations to stream data to the server.
          </li>
        </ul>
      </p>

      <section>
        <h2>Namespaces and Prefixes</h2>
        <p>
          <ul>
            <li> All functions in this module are assigned to the
              <code>http://basex.org/modules/archive</code> namespace.
              In this document, the <code>http</code> prefix is bound to this URI.
            </li>
            <li> Error codes are assigned to the namespace <code>http://expath.org/ns/error</code> namespace.
              The <code>err</code> prefix is bound to this URI.
            </li>
          </ul>
        </p>
      </section>
    </section>

    <section id='functions'>
      <h2>Functions</h2>
      <p>
        The defined functions have several things in common:
        <ul>
          <li> All functions come with a <code>$uri</code>. For simplicity, it is of type <code>xs:string</code> (instead of <code>xs:anyURI</code>).</li>
          <li> The <code>$body</code> parameter is explained in <a href="#request-syntax" class="sectionRef"></a>.</li>
          <li> In <a href="#request-options" class="sectionRef"></a>, the supported <code>$options</code> are described.</li>
          <li> In <a href="#response" class="sectionRef"></a>, the format of the returned map is specified.
            It is identical for all functions except for <a href="#http-options">http:options</a>.</li>
        </ul>
        
        The <code>http:send-request</code> function is available as well; it is specified in the original
        <a href='http://expath.org/spec/http-client/'>HTTP Client Module</a>.
      </p>

      <section>
        <h3>http:get</h3>
        <div class="exampleInner">
          <pre>
http:get($uri as xs:string) as map(*)
http:get($uri as xs:string, $options as map(*)) as map(*)
</pre>
        </div>
        <p>
          Sends a GET request to the specified <code>$uri</code> and returns the response as a map.
          Additional <code>$options</code> can be supplied.
        </p>
      </section>

      <section>
        <h3>http:post</h3>
        <div class="exampleInner">
          <pre>
http:post($uri as xs:string, $body as item()?) as map(*)
http:post($uri as xs:string, $body as item()?, $options as map(*)) as map(*)
</pre>
        </div>
        <p>
          Sends a POST request with an optional <code>$body</code> to the specified <code>$uri</code>
          and returns the response as a map.
          Additional <code>$options</code> can be specified.
        </p>
      </section>

      <section>
        <h3>http:put</h3>
        <div class="exampleInner">
          <pre>
http:put($uri as xs:string, $body as item()?) as map(*)
http:put($uri as xs:string, $body as item()?, $options as map(*)) as map(*)
</pre>
        </div>
        <p>
          Sends a PUT request with an optional <code>$body</code> to the specified <code>$uri</code>
          and returns the response as a map.
          Additional <code>$options</code> can be specified.
        </p>
      </section>

      <section>
        <h3>http:delete</h3>
        <div class="exampleInner">
          <pre>
http:delete($uri as xs:string) as map(*)
http:delete($uri as xs:string, $options as map(*)) as map(*)
</pre>
        </div>
        <p>
          Sends a DELETE request to the specified <code>$uri</code> and returns the response as a map.
          Additional <code>$options</code> can be specified.
        </p>
      </section>

      <section>
        <h3>http:head</h3>
        <div class="exampleInner">
          <pre>
http:head($uri as xs:string) as map(*)
http:head($uri as xs:string, $options as map(*)) as map(*)
</pre>
        </div>
        <p>
          Sends a HEAD request to the specified <code>$uri</code> and returns the response as a map.
          Additional <code>$options</code> can be specified.
        </p>
      </section>

      <section>
        <h3>http:options</h3>
        <div class="exampleInner">
          <pre>
http:options($uri as xs:string) as xs:string*
http:options($uri as xs:string, $options as map(*)) as xs:string*
</pre>
        </div>
        <p>
          Sends an OPTIONS request to the specified <code>$uri</code> and returns the supported methods
          as a sequence of strings.
          Additional <code>$options</code> can be supplied.
        </p>
      </section>

      <section>
        <h3>http:send</h3>
        <div class="exampleInner">
          <pre>
http:send($uri as xs:string, $method as xs:string) as map(*)
http:send($uri as xs:string, $method as xs:string, $body as item()?) as map(*)
http:send($uri as xs:string, $method as xs:string, $body as item()?, $options as map(*)) as map(*)
</pre>
        </div>
        <p>
          Sends a custom HTTP request with the specified <code>$method</code> and an optional
          <code>$body</code> to the specified <code>$uri</code> and returns the response as a map.
          Additional <code>$options</code> can be specified.
        </p>
      </section>

    </section>

    <section id='request'>
      <h2>The Request</h2>
      <p>…</p>

      <section id='request-syntax'>
        <h3>Request Syntax</h3>
        <p>…</p>
      </section>

      <section id='request-options'>
        <h3>Request Options</h3>
        <p>…</p>
      </section>

    </section>

    <section id='response'>
      <h2>The Response</h2>
      <p>…</p>
    </section>

    <section>
      <h2>Acknowledgements</h2>
      <p>
        Many thanks to Robin Berjon for making the production of this specification much simpler
        with his cool ReSpec tool.
      </p>
    </section>
  </body>
</html>
